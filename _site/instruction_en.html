<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Preparation for accessing Cloud platform services,including descriptions for general parameters,Introduction to signature rule for authorization,Example for ...">
<meta name="keywords" content=" ">
<title>General Developer Instruction | Jekyll theme for documentation</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> CoolKit Cloud Platform</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
		<li style="line-height: 50px;">
		    <label><a href="index.html">中文</a></label>
		    <label><a href="platformOverview_en.html">English</a></label>
		</li>
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="General Developer Instruction">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">CoolKit Cloud Platform 2.0</li>
  
  
  
  <li>
      
      <a href="platformOverview_en.html">Platform Overview</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="apiFee_en.html">API Fee</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#">Getting Started</a>
      
      <ul>
          
          
          
          <li><a href="developerGuide_en.html">Developer Guide</a></li>
          
          
          
          
          
          
          <li><a href="develop_en.html">Prepare Your Development Environment</a></li>
          
          
          
          
          
          
          <li><a href="developer_en.html">Become A Developer</a></li>
          
          
          
          
          
          
          <li><a href="application_en.html">Create Your First Application</a></li>
          
          
          
          
          
          
          <li class="active"><a href="instruction_en.html">General Developer Instruction</a></li>
          
          
          
          
          
          
          <li><a href="pair_en.html">Pairing Process</a></li>
          
          
          
          
          
          
          <li><a href="sdk_en.html">SDK</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#">API Center</a>
      
      <ul>
          
          
          
          <li><a href="apiOverview_en.html">API Overview</a></li>
          
          
          
          <li class="subfolders">
              <a href="#">Region</a>
              <ul>
                  
                  
                  
                  <li><a href="region_en.html">Check current region</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a href="#">Account Management</a>
              <ul>
                  
                  
                  
                  <li><a href="code_en.html">Verification code</a></li>
                  
                  
                  
                  
                  
                  <li><a href="register_en.html">Register</a></li>
                  
                  
                  
                  
                  
                  <li><a href="findpassword_en.html">Reset password</a></li>
                  
                  
                  
                  
                  
                  <li><a href="updatePassword_en.html">Change Password</a></li>
                  
                  
                  
                  
                  
                  <li><a href="login_en.html">Login</a></li>
                  
                  
                  
                  
                  
                  <li><a href="token_en.html">Token Refresh</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a href="#">Device Management</a>
              <ul>
                  
                  
                  
                  <li><a href="devices_en.html">Device List</a></li>
                  
                  
                  
                  
                  
                  <li><a href="device_en.html">Check Device</a></li>
                  
                  
                  
                  
                  
                  <li><a href="addDevice_en.html">Add Device</a></li>
                  
                  
                  
                  
                  
                  <li><a href="deleteDevice_en.html">Delete Device</a></li>
                  
                  
                  
                  
                  
                  <li><a href="updateDevice_en.html">Change Device Name</a></li>
                  
                  
                  
                  
                  
                  <li><a href="addGsm_en.html">Add GSM Device</a></li>
                  
                  
                  
                  
                  
                  <li><a href="addDeviceGroup_en.html">Add Group</a></li>
                  
                  
                  
                  
                  
                  <li><a href="updateGroup_en.html">Change Group</a></li>
                  
                  
                  
                  
                  
                  <li><a href="deleteGroup_en.html">Delete Group</a></li>
                  
                  
                  
                  
                  
                  <li><a href="addToGroup_en.html">Add device to Group</a></li>
                  
                  
                  
                  
                  
                  <li><a href="findGroup_en.html">Check Group</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a href="#">Device Control</a>
              <ul>
                  
                  
                  
                  <li><a href="dispatch_en.html">Server Dispatch</a></li>
                  
                  
                  
                  
                  
                  <li><a href="handshake_en.html">Handshake</a></li>
                  
                  
                  
                  
                  
                  <li><a href="online_en.html">Device Online/Offline</a></li>
                  
                  
                  
                  
                  
                  <li><a href="deviceStatus_en.html">Update/Report Status</a></li>
                  
                  
                  
                  
                  
                  <li><a href="findStatus_en.html">Check Device Status</a></li>
                  
                  
                  
                  
                  
                  <li><a href="share_en.html">Share Device</a></li>
                  
                  
                  
                  
                  
                  <li><a href="shareUpdate_en.html">Update Share</a></li>
                  
                  
                  
                  
                  
                  <li><a href="shareCancel_en.html">Cancel Share</a></li>
                  
                  
                  
                  
                  
                  <li><a href="deviceStatusHttp_en.html">Check Device Status</a></li>
                  
                  
                  
                  
                  
                  <li><a href="updateStatusHttp_en.html">Update Device Status</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#">FAQ</a>
      
      <ul>
          
          
          
          <li><a href="faqOauth_en.html">Authentication</a></li>
          
          
          
          
          
          
          <li><a href="faqCode_en.html">Verification code</a></li>
          
          
          
          
          
          
          <li><a href="faqAccount_en.html">Account</a></li>
          
          
          
          
          
          
          <li><a href="faqDevice_en.html">Device</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="contactUs_en.html">Contact Us</a>
      
      <ul>
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">General Developer Instruction</h1>
</div>



<div class="post-content">

   
    <div class="summary">Preparation for accessing Cloud platform services,including descriptions for general parameters,Introduction to signature rule for authorization,Example for signature calculation, and expanation for Access Token and Refresh Token.</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

   <h2 id="general-developer-instruction">General Developer Instruction</h2>

<p>Description：Parameters in general instruction are public for all APIs.Accessing API takes both general parameters and API parameters.（General developer instruction only applies to REST API.For WebSocket API, <a href="dispatch_en.html">please check</a>）</p>
<ul>
  <li>HTTP Request Header should specify Content-Type:application/json</li>
  <li>Character Encoding：utf-8</li>
  <li>The Authorization field of HTTP Request Header must include signature or access token value</li>
  <li>Both HTTP and websocket uses SSL/TLS，port is 8080，Server end supports SSLV3,TLS1.1, TLS 1.2</li>
</ul>

<p><strong>Required Parameters as follows：</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parameter</th>
      <th style="text-align: left">Required</th>
      <th style="text-align: left">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">ts</td>
      <td style="text-align: left">Yes</td>
      <td style="text-align: left">Long</td>
      <td>Timestamp of API calling,say current timestamp （Timestamp：current time in seconds from Epoch（Jan 1, 1970），say unix-timestamp）</td>
    </tr>
    <tr>
      <td style="text-align: left">appid</td>
      <td style="text-align: left">Yes</td>
      <td style="text-align: left">String</td>
      <td>appid provided by Coolkit</td>
    </tr>
    <tr>
      <td style="text-align: left">nonce</td>
      <td style="text-align: left">Yes</td>
      <td style="text-align: left">String</td>
      <td>8-digit random alphanumeric String</td>
    </tr>
    <tr>
      <td style="text-align: left">version</td>
      <td style="text-align: left">Yes</td>
      <td style="text-align: left">Int</td>
      <td>version:8 Agreed Version</td>
    </tr>
    <tr>
      <td style="text-align: left">appVersion</td>
      <td style="text-align: left">No</td>
      <td style="text-align: left">String</td>
      <td>when version&gt;=8 appVersion is required</td>
    </tr>
  </tbody>
</table>

<h2 id="signature-rule">Signature Rule</h2>
<ul>
  <li>All API accessing(including login) before login requires signature calculation.Signature value is put in Authorization Header of HTTP.For example:
 Authorization:Sign QtKh6EnKoNmPnv17Ump3b/6r2hjojWb4nqSt4lnyj2U=</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Please refer to 'Signature Calculation' below for Signature Algorithmc
</code></pre></div></div>

<ul>
  <li>GET Request：
Order all parameters alphabetically based on the names of parameters and concatenate them with &amp;.</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>appid=I25m0KljbFfGsTjRc3eTwTEPVwKzsvCF&amp;deviceid=1000052354&amp;nonce=2323dfgh&amp;ts=1545219251
</code></pre></div></div>

<p>Signature Calculation: Set ‘app secret’ as key，generate sigature String based on HMAC-SHA256.</p>

<p>Encode the signature String by Base64 and add to Authorization header.</p>

<ul>
  <li>POST Request:
Create json data with signature String and all other parameters(parameters in general instruction and API parameters)，Take example of Login API.For example:
<code class="highlighter-rouge">{"appid":"I25m0KljbFfGsTjRc3eTwTEPVwKzsvCF","nonce":"232323df","ts":1545219251,"version":8,"phoneNumber":"+86********","password":"****"}</code>
Or
<code class="highlighter-rouge">{"appid":"I25m0KljbFfGsTjRc3eTwTEPVwKzsvCF","nonce":"232323df","ts":1545219251,"version":8,"email":"dev@coolit.cc","password":"****"}</code>
Note：Country code must be added to phoneNumber,such as：+86</li>
</ul>

<p>Only one of phoneNumber and email need to be passed.phoneNumber is passed only for accounts in cn region.email is passed for other regions.</p>

<h2 id="signature-calculation">Signature Calculation</h2>

<p>Signature Algorithm demo: 【nodejs】 taking example of login API</p>

<p>method:POST（GET method to check signature rule）</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var crypto = require('crypto');
var appid="I25m0KljbFfGsTjRc3eTwTEPVwKzsvCF";
var appsecret="S1fHFiMqzykNdxlSrk9Pjdczp7rsvt3M";
var params={"appid":"I25m0KljbFfGsTjRc3eTwTEPVwKzsvCF","phoneNumber":"+8613570211955","password":"lybywl163","ts":1545219251123,"version":8,"nonce":"asbsedwq"}
var buffer = new Buffer(JSON.Stringify(params),"utf-8");
var theSign = crypto.createHmac('sha256', appsecret).update(buffer).digest('base64')
</code></pre></div></div>

<p>Signature value calculated from parameters above
<code class="highlighter-rouge">"QtKh6EnKoNmPnv17Ump3b/6r2hjojWb4nqSt4lnyj2U="</code></p>

<p>You can use demo parameters in your own authorization calculation.If the signature value is same as the one above, your signature algorithm is working correctly.</p>

<h2 id="descirptions-for-access-token-and-refresh-tokensay-at-and-rt-returned-after-login">Descirptions for Access Token and Refresh Token（Say at and rt returned after login）</h2>
<p>After login,all API callings require adding access tocken in Authorization header.For example:</p>

<p>Authorization: Bearer 1832d4a0f5f5f5845cb1922c1091c8aa5dfe0041</p>

<p>（1832d4a0f5f5f5845cb1922c1091c8aa5dfe0041 is at returned after login）</p>

<p>After login succeeds,access token will be returned（at returned after login，say access token）.</p>

<p>access token remains valid for one month.One account can not be logined by multiple users at the same time.Every time one logins,token will be refreshed.Thus,the second user who logins later will refresh the token and make the token of previous user expire.First user will be forced to log out.</p>

<p>refresh token remains valid for two months.When access token expires,access token and refresh token can be regained by accessing refresh token API.<a href="token.html">Please check Token Refresh</a></p>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2019 Coolkit Technology Co.,Ltd. All rights reserved. <br />
<span>Page last updated:</span> 2019-03-20<br/>
<p><img src="images/coolkit.png" alt="CoolKit"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>
</html>
